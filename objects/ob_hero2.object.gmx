<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sp_hero2_move</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>-1</persistent>
  <parentName>ob_heroparent</parentName>
  <maskName>sp_hero2_stand</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>wavespeed = 3

megafire = noone
hurt = false
control = true

image_speed = 0.1
forward = 1 // 1 или -1 
feetcollision = false
gravity = 0.5

accel = 0 
jumpaccel =0
maxspeed = 3
fallmaxspeed = 15
xspeed = 0
yspeed = 0
canjump = true
powerjump = 0
landtime = 0
shoot = true
recover = false


maxhealth = 10
health  = maxhealth

dead = false
alarm[0] = -1

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>RESTART AFTER DEATH</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Restore stats

hurt = false
dead = false
control = true
shoot = true
health = 10
vspeed = 0
hspeed = 0
image_speed = 0.1
landtime = 0
powerjump = 0
accel = 0
megashot = noone

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>hurt</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>false</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>612</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>-1</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_if_variable</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>0</kind>
            <string>dead</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>false</string>
          </argument>
          <argument>
            <kind>4</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>422</id>
        <kind>1</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// control
var animType = sp_hero2_stand

//jumpaccel = 0
//if feetcollision hspeed *= 0.88 else hspeed *= 0.96
accel = 0

if control {
// Кнопки
    if keys[k_Left] {
        forward = -1
        accel = 0.25 * forward
        animType = sp_hero2_move
    } 
    if keys[k_Right] {
        forward = 1
        accel = 0.25 * forward
        animType = sp_hero2_move       
    } 
    if keys[k_Down] and feetcollision {
        animType = sp_hero2_jump
        mask_index = sp_coll2_sit
        image_index = 1
        accel = 0  // prevent moving 
    }
    if not keys[k_Down] {
        mask_index = sp_hero2_stand
    }
    if keys[k_Jump] and feetcollision 
    if canjump {
        canjump = false    
        if powerjump &lt; 7 powerjump += 0.3
        animType = sp_hero2_jump
        image_index = 1
        accel = 0  // prevent moving 
    }
    if not (keys[k_Jump]) and feetcollision 
    if powerjump &gt; 0 {
        vspeed = -( 5 + powerjump)
        powerjump = 0 
        sc_play_sound(sn_arrow4, false)
    }
    if keys[k_Fire] {
         // fire on ground
        if landtime&lt;=0  
        if feetcollision { 
            if shoot {
                sc_play_sound(sn_wing, false)
                shoot = false
                animType = sp_hero2_altfire
                image_index = 0
                alarm[1] = 30
            }    
            if image_index &gt; 2.8     // stop anim at last frame
                image_index = 2
        }    
           // fire when in jump
        if sprite_index != sp_hero2_jumpfire 
        if not feetcollision {  
            animType = sp_hero2_jumpfire
            vspeed = 5
            hspeed = maxspeed * forward
        }
    }
    if keys[k_altFire] and feetcollision {
        animType = sp_hero2_fire
        canjump = false
//        shoot = false
        accel = 0
        if not instance_exists(megafire) {
            megafire = instance_create(x,y,ob_megashot)       
        }   
    } else {
        canjump = true
//        shoot = true
        if instance_exists(megafire) {
          audio_stop_sound(sn_replenish)
          if megafire.powerUp &gt; 10 {
              megafire.phase = ms_Shoot   
              sc_play_sound(sn_fire, false)
          } else megafire.phase = ms_Fadeout       
          megafire = noone
        }  
    } 
}

// process anims

// when you fly
if animType != sp_hero2_jumpfire
if (abs(vspeed) &gt; 0) or (feetcollision == false) {
    animType = sp_hero2_jump
    gravity = 0.5
    if vspeed&lt;0
        image_index = 0
    else {
        canjump = true
        image_index = 2
    }
    landtime = 10
}

// when you sp_hero2_altfire (fire on ground)
if sprite_index == sp_hero2_altfire {
    animType = sp_hero2_altfire
    accel = 0
       // create damaging object (shot)
    if image_index &gt; 1 and image_index &lt; 1.2 {
//        sc_play_sound(sn_wing, false)
        with instance_create( x + 24*forward, y, ob_shot_wave) {
           forward = hero.forward
           image_xscale = forward
           speed = other.wavespeed * forward
        }   
    }   // switch anim to stand when anim finishes 
    if image_index &gt; 2.8 {
        animType = sp_hero2_stand
    }
}

// when you in sp_hero2_jumpfire
if sprite_index == sp_hero2_jumpfire {
    animType = sp_hero2_jumpfire
    with instance_create(x+hspeed*2, y+vspeed*2, ob_shot_jumphit)
      forward = other.forward
}


// when you land 
if feetcollision {
    if landtime&gt;0 { 
        landtime--
        animType = sp_hero2_jump
        image_index = 1
        accel = 0
    }
}      

image_xscale = forward
sprite_index = animType



</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>424</id>
        <kind>2</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// process move


//if jumpaccel&gt;0 show_debug_message('jumpaccel: '+ string(jumpaccel))
//vspeed += jumpaccel
hspeed += accel

if feetcollision {
  hspeed *= 0.88
} else {
  hspeed *= 0.96
}  

if abs(hspeed)&gt;maxspeed hspeed = maxspeed*forward
if vspeed&gt;fallmaxspeed vspeed = fallmaxspeed

//debugstr = 'image i'+ string(image_index)

if hurt {
    if image_index &gt;2.8 {
        sprite_index = sp_hero2_stand
        image_speed = 0.1
        hurt = false
        control = true
        landtime = 0
        powerjump = 0
        recover = true
        alarm[2] = 60          // time of recover
//        alarm[3] = room_speed * 0.1    // speed of flashing
    }
}


</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// check status

// death
if health == 0 {
    sprite_index = sp_hero2_dead
//    image_index = 0
    image_speed = 0.05
    hurt = false
}    

if dead {
    if image_index &gt; 2.9 image_speed = 0
}



feetcollision = false

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="ob_eyefloor">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Check collision eye
//if dead exit

mask_index = sp_coll2_up
if place_meeting(x, y, other) {
  while place_meeting(x, y, other) y++   
  vspeed = 0
}

mask_index = sp_coll2_down
if place_meeting(x, y, other) {
  while place_meeting(x, y, other) y--   
  if vspeed &gt; 10 
    sc_play_sound(sn_hit3, false)
  y += 1
  gravity = 0
  vspeed = 0
  feetcollision = true
}

mask_index = sp_coll2_right
if place_meeting(x, y, other) {
  while place_meeting(x, y, other) x--   
  hspeed = 0
}

mask_index = sp_coll2_left
if place_meeting(x, y, other) {
  while place_meeting(x, y, other) x++   
  hspeed = 0
}

mask_index = sp_hero2_stand

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="ob_crashfloor">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Check collision
//if dead exit
if other.awake exit

if vspeed &gt;= 0 {
    mask_index = sp_coll2_down
    if place_meeting(x, y, other) {
      while place_meeting(x, y, other) y--   
      if vspeed &gt; 10 
        sc_play_sound(sn_hit3, false)
      y += 1
      gravity = 0
      vspeed = 0
      feetcollision = true
    }
    
    mask_index = sp_hero2_stand
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="ob_spike">
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// spike of hurt
if dead exit
if hurt exit
if recover exit

show_debug_message('Hurt with ' +sprite_get_name(sprite_index))
x -= hspeed
y -= vspeed
vspeed = -6.5
gravity = 0.5
hspeed = -maxspeed * sign(other.x - x)
accel = 0

sprite_index = sp_hero2_hurt
image_speed = 0.05
image_index = 0

hurt = true
control = false
health -- 


</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Play sound

sc_play_sound(sn_hit4, false)

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="ob_wall">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Check collision
//if dead exit
image_xscale = 1

mask_index = sp_coll2_up
if place_meeting(x, y, other) {
  while place_meeting(x, y, other) y++   
  vspeed = 0
}

mask_index = sp_coll2_down
if place_meeting(x, y, other) {
  while place_meeting(x, y, other) y--   
  if vspeed &gt; 10 
    sc_play_sound(sn_hit3, false)
  y += 1
  gravity = 0
  vspeed = 0
  feetcollision = true
}

mask_index = sp_coll2_right
if place_meeting(x, y, other) {
  while place_meeting(x, y, other) x--   
  hspeed = 0
}

mask_index = sp_coll2_left
if place_meeting(x, y, other) {
  while place_meeting(x, y, other) x++   
  hspeed = 0
}

image_xscale = forward
mask_index = sp_hero2_stand

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="ob_lift">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Check lift collision

mask_index = sp_coll2_down
event_inherited()
mask_index = sp_hero2_stand

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// When goto next room

megashot = noone

</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints>
    <point>16,16</point>
    <point>20,20</point>
  </PhysicsShapePoints>
</object>
