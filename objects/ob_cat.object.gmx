<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sp_cat_walk</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>ob_enemy</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>image_speed = 0
mode = 0
phase = 0
timeout = 0
forward = -1

fallmaxspeed = 4
maxspeed = 2
accel = 0
range = 10 // шагов по 16
//seehero = false

//gravity = 0.2
strength = 1
dropvalue = 20
dropitem = ob_drop_coin

feetcollision = false
sidecollision = false

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// AI


accel = 0

// start mode
if mode == 0 {    // Idle
    if timeout &lt;= 0 {
        phase = irandom(1)
        switch phase {    // start phase
        case 0: {       // bark
            timeout = random(50)+20
            forward = irandom(1)*2 - 1
            sprite_index = sp_cat_bark
            image_speed = 0.1
            image_blend = c_white
//            hspeed = 0
            break
        }  
        case 1: {       // walk
            timeout = random(20)+10
            forward = irandom(1)*2 - 1
            maxspeed = 2
            sprite_index = sp_cat_walk
            image_blend = c_white
            image_speed = 0.1
            break    
        }
        }
    } 
    timeout--
}


// process modes
if mode == 0 {   // idle
   // process phase
   if phase == 1 {
       accel = 0.1
       if sidecollision and feetcollision {
           vspeed = -3
       }  
   }    
}

if mode == 1 {   // attack
    timeout -= maxspeed     // timeout as distance
    if timeout &gt; 70 {
        accel = 0.15
        if sidecollision and feetcollision
           vspeed = -3
    } else {
        accel = 0.05
        if feetcollision vspeed = -3.5
        sprite_index = sp_cat_walk
        image_index = 0
        mode = 0
        timeout = 60
    }
    
}

// ALWAYS
if feetcollision {   
    hspeed *= 0.88
    gravity = 0
} else
    gravity = 0.2  

hspeed+=accel*forward

if abs(hspeed) &gt; maxspeed hspeed = maxspeed*forward
//if vspeed&gt;fallmaxspeed    vspeed = fallmaxspeed
  
// check range ahead  
var _x, _y, i=0, j=0, out = false;
//repeat (2) {
//    j++
//    _y = y - 16*j
//    i=0
    repeat (range) {
        i++
        _x = x + 15*i*forward
        _y = y - 16
        if collision_point(_x, _y, hero, false, true) {
            mode = 1     // start attack
            maxspeed = 2.5
            timeout = point_distance(x,y, hero.x, hero.y)
            sprite_index = sp_cat_walk
            out = true
            break
        }
//        instance_create(_x, _y, ob_mark)
        if collision_point(_x, _y, ob_wall, false, true) {
            break
        }  
    }   
//    if out break
//}


image_xscale = forward
feetcollision = false
sidecollision = false

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
    </event>
    <event eventtype="4" ename="ob_megashot">
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Enemy knock back
vspeed = -0.5
hspeed = maxspeed*0.5 * other.forward

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="ob_shot_jumphit">
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Enemy knock back

vspeed = -0.5
hspeed = maxspeed * other.forward

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="ob_shot_wave">
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Enemy knock back
vspeed = -2.5
hspeed = maxspeed*0.5 * other.forward

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="ob_arrow">
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Enemy knock back
vspeed = -0.5
hspeed = maxspeed*0.5 * other.forward

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="ob_abyss">
      <action>
        <libid>1</libid>
        <id>203</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_kill_object</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
    </event>
    <event eventtype="4" ename="ob_eyefloor">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Check collision

image_xscale = 1

mask_index = sp_collcat_up
if place_meeting(x, y, other) {
//  y -= vspeed
  vspeed = 0
  while place_meeting(x,y, other) y++  
}

mask_index = sp_collcat_down
if place_meeting(x, y, other) {
  y -= vspeed
  vspeed = 0
  feetcollision = true
}

mask_index = sp_collcat_right
if place_meeting(x, y, other) {
//  x -= hspeed
  hspeed = 0
  while place_meeting(x,y, other) x--   
  sidecollision = true
}

mask_index = sp_collcat_left
if place_meeting(x, y, other) {
//  x -= hspeed
  hspeed = 0
  while place_meeting(x,y, other) x++   
  sidecollision = true
}

image_xscale = forward
mask_index = sp_cat_bark

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="ob_crashfloor">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Check collision

image_xscale = 1

mask_index = sp_collcat_up
if place_meeting(x, y, other) {
//  y -= vspeed
  vspeed = 0
  while place_meeting(x,y, other) y++  
}

mask_index = sp_collcat_down
if place_meeting(x, y, other) {
  y -= vspeed
  vspeed = 0
  feetcollision = true
}

mask_index = sp_collcat_right
if place_meeting(x, y, other) {
//  x -= hspeed
  hspeed = 0
  while place_meeting(x,y, other) x--   
  sidecollision = true
}

mask_index = sp_collcat_left
if place_meeting(x, y, other) {
//  x -= hspeed
  hspeed = 0
  while place_meeting(x,y, other) x++   
  sidecollision = true
}

image_xscale = forward
mask_index = sp_cat_bark

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="ob_wall">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Check collision

image_xscale = 1

mask_index = sp_collcat_up
if place_meeting(x, y, other) {
  vspeed = 0
  while place_meeting(x,y, other) y++  
}

mask_index = sp_collcat_down
if place_meeting(x, y, other) {
  vspeed = 0
  while place_meeting(x,y, other) y--  
  y += 1
  feetcollision = true
}

mask_index = sp_collcat_right
if place_meeting(x, y, other) {
//  x -= hspeed
  hspeed = 0
  while place_meeting(x,y, other) x--   
  sidecollision = true
}

mask_index = sp_collcat_left
if place_meeting(x, y, other) {
//  x -= hspeed
  hspeed = 0
  while place_meeting(x,y, other) x++   
  sidecollision = true
}

image_xscale = forward
mask_index = sp_cat_bark

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="ob_lift">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Check collision

image_xscale = 1

mask_index = sp_collcat_up
if place_meeting(x, y, other) {
//  y -= vspeed
  vspeed = 0
  while place_meeting(x,y, other) y++  
}

mask_index = sp_collcat_down
if place_meeting(x, y, other) {
  y -= vspeed
  vspeed = 0
  feetcollision = true
}

mask_index = sp_collcat_right
if place_meeting(x, y, other) {
//  x -= hspeed
  hspeed = 0
  while place_meeting(x,y, other) x--   
  sidecollision = true
}

mask_index = sp_collcat_left
if place_meeting(x, y, other) {
//  x -= hspeed
  hspeed = 0
  while place_meeting(x,y, other) x++   
  sidecollision = true
}

image_xscale = forward
mask_index = sp_cat_bark

</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints>
    <point>16,16</point>
    <point>16,16</point>
  </PhysicsShapePoints>
</object>
